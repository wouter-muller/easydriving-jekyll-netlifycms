<div class="s-map">
    <div class="l-wrapper">
        <h2 class="c-heading --large --green u-align-center u-mb">{{ site.data.our_cars_page.map_heading }}</h2>
        <div class="u-align-center u-mb+">
            <p class="c-paragraph u-mb+">{{ site.data.our_cars_page.map_text_above_map }}</p>
        </div>
    </div>

    <div id="map" class="u-mb+" style="width: 100%; height: 400px; background-color: grey"></div>

    <div class="l-wrapper">
        <div class="u-align-center">
            <h2 class="c-heading --medium u-mb">{{ site.data.our_cars_page.map_heading_below_map }}</h2>
            <p class="c-paragraph">{{ site.data.our_cars_page.map_text_below_map }}</p>
        </div>
    </div>
</div>

<script>
    function initMap() {
      var center = {lat: 53.300221, lng: 6.603473};
      var locations = [
        {% for location in site.data.settings.car_locations %}
            ['{{location.address}}', {{location.lat}}, {{location.long}}],
        {% endfor %}
      ];
    var map = new google.maps.Map(document.getElementById('map'), {

        zoom: {{ site.data.our_cars_page.zoom_level }},
        center: center
      });
    var infowindow =  new google.maps.InfoWindow({});
    var marker, count;
    for (count = 0; count < locations.length; count++) {
        marker = new google.maps.Marker({
          position: new google.maps.LatLng(locations[count][1], locations[count][2]),
          map: map,
          title: locations[count][0]
        });
    google.maps.event.addListener(marker, 'click', (function (marker, count) {
          return function () {
            infowindow.setContent(locations[count][0]);
            infowindow.open(map, marker);
          }
        })(marker, count));
      }
    }
</script>

<script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAtMaNFLROn3HLbR2pZIKdjhIhnH5FB2kI&callback=initMap">
</script>
